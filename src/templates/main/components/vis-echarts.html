{% load static %}
<style>
  /* Add CSS for borders */
  .row div {
    border: 1px solid #ccc;
    padding: 10px;
    /* Optional: Add padding for better spacing */
  }
</style>
<!-- Start Component -->
{% block vis_echarts %}
<div class="container">
  <div class="row">
    <div class="col-12">
      <div id="main" style="width: 100%; height: 300px;"></div>
      <script type="text/javascript">
        // Initialize ECharts
        var myChart = echarts.init(document.getElementById('main'));

        if (myChart) {
          // Load the BR map data
          $.get("https://info.dengue.mat.br/datasets/cdn/BR.json", function (brJson) {
            // Log the loaded geographic data
            myChart.hideLoading();
            echarts.registerMap('BR', brJson, {
              'Acre': {
                left: -76,
                top: 26,
                width: 2
              }
            });
            // Fake data
            var br_data = [
                        // { name: 'Acre', value: 5000 },
                        // { name: 'Alagoas', value: 7500 },
                        // { name: 'Amapá', value: 3000 },
                        // { name: 'Amazonas', value: 9000 },
                        // { name: 'Bahia', value: 12000 },
                        // { name: 'Ceará', value: 150000 },
                        // { name: 'Distrito Federal', value: 7000 },
                        // { name: 'Espírito Santo', value: 8500 },
                        // { name: 'Goiás', value: 10500 },
                        // { name: 'Maranhão', value: 4500 },
                        // { name: 'Mato Grosso', value: 6200 },
                        // { name: 'Mato Grosso do Sul', value: 4700 },
                        // { name: 'Minas Gerais', value: 20000 },
                        { name: 'Pará', value: 8000 },
                        { name: 'Paraíba', value: 6000 },
                        { name: 'Paraná', value: 14500 },
                        // { name: 'Pernambuco', value: 11000 },
                        // { name: 'Piauí', value: 4000 },
                        { name: 'Rio de Janeiro', value: 18000 },
                        // { name: 'Rio Grande do Norte', value: 5500 },
                        // { name: 'Rio Grande do Sul', value: 14000 },
                        // { name: 'Rondônia', value: 3500 },
                        // { name: 'Roraima', value: 2500 },
                        { name: 'Santa Catarina', value: 12000 },
                        // { name: 'São Paulo', value: 25000 },
                        // { name: 'Sergipe', value: 3500 },
                        // { name: 'Tocantins', value: 3000 }
            ];

            br_data.sort(function (a, b) {
              return a.value - b.value;
            });

            const mapOption = {
              visualMap: {
                left: 'right',
                min: 5000,
                max: 636000,
                inRange: {
                  // prettier-ignore
                  color: [
                    '#313695', '#4575b4', '#74add1', '#abd9e9', '#e0f3f8',
                    '#ffffbf', '#fee090', '#fdae61', '#f46d43', '#d73027', '#a50026'
                  ]
                },
                text: ['High', 'Low'],
                calculable: true
              },
              series: [
                {
                  id: 'population',
                  type: 'map',
                  roam: true,
                  map: 'BR',
                  animationDurationUpdate: 2000,
                  universalTransition: true,
                  data: br_data
                }
              ]
            };

            const barOption = {
              xAxis: {
                type: 'value'
              },
              yAxis: {
                type: 'category',
                axisLabel: {
                  rotate: 30
                },
                data: br_data.map(function (item) {
                  return item.name;
                })
              },
              animationDurationUpdate: 2000,
              series: {
                type: 'bar',
                id: 'population',
                data: br_data.map(function (item) {
                  return item.value;
                }),
                universalTransition: true
              }
            };

            let currentOption = mapOption;

            myChart.setOption(mapOption);

            setInterval(function () {
              currentOption = currentOption === mapOption ? barOption : mapOption;
              myChart.setOption(currentOption, true);
            }, 5000);
          });
        }
      </script>
    </div>
  </div>
</div>
{% endblock %}
